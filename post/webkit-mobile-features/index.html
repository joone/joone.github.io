<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WebKit Mobile Features  | posts</title>
  <meta name="description" content=" 'WebKit Mobile Features'read this article.">
  <meta property="og:title" content="WebKit Mobile Features">
  
  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2011-05-21">
  
  <meta property="og:description" content=" 'WebKit Mobile Features'read this article.">
  <meta property="og:url" content="/post/webkit-mobile-features/">
  <meta property="og:site_name" content="posts">
  
  <meta property="og:image" content="/images/thumbnail.png">
  
  
  <meta property="og:tags" content="Webkit">
  
  <meta property="og:tags" content="mobile">
  
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="canonical" href="/post/webkit-mobile-features/">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/agate.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+KR&display=swap">
  <link rel="stylesheet" href="/css/styles.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  
  
  
  <script type="text/javascript">
  function toggle_visibility(id) {
    var e = document.getElementById(id);
    if (e.className === 'menu')
      e.className = 'menu hidden';
    else
      e.className = 'menu';
  }
  </script>
</head>
<body>
  <div class="navbar">    
    <div class="logo">
      <a href="/">
        <img src="/images/logo.png" height="34px" />
      </a>
    </div>
    <div class="burger">
      <button onclick="toggle_visibility('menu')">
        <i class="fa fa-bars" aria-hidden="true"></i> Menu
      </button>
    </div>
    <div id="menu" class="menu hidden">
      <ul>
        <li><a href="/">posts</a></li>
        <li><a href="/categories">categories</a></li>
        <li><a href="/tags">tags</a></li>
      </ul>
      <input class="search" id="search-input" type="search" placeholder="Keyword" value="">
    </div>
  </div>
  <div class="container">    


<div class="post">
  <div class="post-title">
    <a href="/post/webkit-mobile-features/">
      <div class="post-meta">
        <time>Saturday, May 21, 2011 01:04</time>
        <h1>WebKit Mobile Features</h1>
      </div>
    </a>
  </div>
  <div class="post-toc">
    <span class="title">TOC</span>
    <nav id="TableOfContents"></nav>
  </div>
  <section class="post-content">
    <p>Recently, I spent some time implementing the viewport meta tags and tiled backing store for WebKitGtk+, which are the mobile features of the WebKit engine. In this post, I’m going to tell you more about the mobile features of the WebKit engine and how to enable each feature when you build WebKitGtk+.</p>
<p>First of all, the WebKit engine is particularly strong in the mobile area, because it is lighter and faster than other browser engines and has been verified by the success of Safari on the iPhone. Due to this reason, most mobile devices have adopted the WebKit engine to offer their own web browser: Nokia Symbian, Google Android, HP WebOS, and Samsung Bada are all using WebKit based browsers.</p>
<p>Additionally, WebKit is an open source project. Naturally, <a href="http://trac.webkit.org/browser">all source code is open to the public</a>, but there is no obligation for manufacturers to open their browser code, because the WebKit engine uses the LGPL, so it allows a browser executable file to just link with the WebKit engine dynamically. It means that the browser can be a different file independent from the WebKit library. Because of this reason, the mobile features of Safari on the iPhone need not be open to the public and subsequently it has been hard to access the mobile features. Fortunately, other phone manufacturers have participated in the WebKit project and are developing mobile features within the community. Currently, Nokia, RIM, Samsung, Motorola and Erricson have participated in the WebKit project. In addition, the open source companies <a href="http://collabora.co.uk/">Collabora</a> and Igalia have worked on WebKit for a long time.</p>
<p>Recently, some mobile features already have been applied to the WebKit engine such as the tiled backing store, touch events, and viewport meta tags. Since these features are a little complicated to understand in terms of the name, I will explain them including the other mobile features supported by WebKit in more details.</p>
<ul>
<li>Fast Mobile Scrolling</li>
<li>Tiled Backing Store</li>
<li>Viewport Meta Tags</li>
<li>Frameset Flattening</li>
<li>Touch Events</li>
</ul>
<p>Fast Mobile Scrolling</p>
<p><a href="http://farm6.static.flickr.com/5182/5597019959_50c470de37.jpg"><img src="http://farm6.static.flickr.com/5182/5597019959_50c470de37.jpg" alt=""></a> </p>
<p>You can see a fixed background image(Smile Icon) when you even scroll the web page as you can see in the above picture. This can be possible if a web page has elements which have the CSS background-attachment property. In this case, WebKit carries out a slow repaint in order to avoid rendering artifacts. However, scrolling a web page with a fixed background image causes noticeable delays on mobile devices. It means that WebKit tries not to update fixed elements every time to scroll fast because it is hard to display a fixed element while scrolling fast.</p>
<p><a href="http://farm6.static.flickr.com/5305/5597587400_3768649994.jpg"><img src="http://farm6.static.flickr.com/5305/5597587400_3768649994.jpg" alt=""></a></p>
<p>In order to avoid this problem, we can make scrolling faster if we ignore the CSS property &ldquo;background-attachment: fixed&rdquo; by enabling the fast mobile scrolling option as you can see in the left picture (i.e. the fixed background can be scrollable on WebKitGtk+ with the fast mobile scrolling build option).</p>
<p>To enable the fast mobile scrolling:</p>
<ol>
<li>Build WebKitGtk+ with the fast mobile scrolling option:</li>
</ol>
<pre><code>$WebKit/Tools/Scripts/build-webkit --gtk --fast-mobile-scrolling
</code></pre><p>Tiled Backing Store</p>
<p>When I tried to use Safari on the iPhone, I was impressed by the fact that the scrolling web pages were very fast. This is possible because Safari caches the content of the web page as bitmaps in memory, and the cached bitmaps we&rsquo;ve seen are just painted on the screen without sending paint calls to WebCore when we scroll a web page. These bitmaps are created and deleted on-demand as the viewport moves over the web page. We call them the “tiled backing store.”</p>
<p><a href="https://bugs.webkit.org/show_bug.cgi?id=35146">The tiled backing store was applied to QtWebKit  by Nokia engineers</a>. They applied this feature to WebCore, so it can be shared by other ports. In the case of WebKitGtk, <a href="https://bugs.webkit.org/show_bug.cgi?id=45423">Code Aurora engineers submitted an initial patch, I have updated the patch to use only Cairo API by removing GTK+ dependency.</a> This would allow the WinCairo and Efl port to use the updated patch for enabling the tiled backing store.</p>
<p>To enable the tiled backing store:<br>
1 ) Build WebKitGtk+ with the tiled backing store option as follows:</p>
<pre><code>$ WebKit/Tools/Scripts/build-webkit --gtk --tiled-backing-store
</code></pre><ol start="2">
<li>Set the tiled backing store setting to TRUE through WebKitWebSettings as follows:</li>
</ol>
<pre><code>WebKitWebSettings \*settings = webkit\_web\_view\_get\_settings(webView);  
g\_object\_set(G\_OBJECT(settings), &quot;enable-tiled-backing-store&quot;, TRUE, NULL);   

</code></pre><p>Viewport Meta Tags</p>
<p><a href="http://farm6.static.flickr.com/5292/5460755418_d6d667e6e1_o.png"><img src="http://farm6.static.flickr.com/5292/5460755418_d6d667e6e1_o.png" alt=""></a> <a href="http://farm6.static.flickr.com/5252/5481285644_9a0d39c365_o.png"><img src="http://farm6.static.flickr.com/5252/5481285644_9a0d39c365_o.png" alt=""></a> </p>
<p>Apple introduced the full browsing feature for the first time when they released the iPhone. Until then, the mobile phone was not usable to browse web pages made for desktop due to the small screen size. To overcome this limitation, Safari on the iPhone zooms web pages out automatically to fit to the screen like in the above picture(left).</p>
<p>For this, Safari on the iPhone assumes that web pages have 980px width by default. When Safari loads a web page, it scales down the web page by a factor of 0.32 (320/980) to fit to the width of  the screen in the case of iPhone 3G. But, the problem is that all pages are not displayed to fit to 980px width. For example, mobile web pages can be displayed well with 320px or 480px. the Google Search page is displayed on the iPhone like the right picture because the Google search page is required to have the less width compared to 980px.</p>
<p>To solve this problem, Apple defined the viewport meta tags to allow web browsers to support desktop web page and mobile web page effectively. Actually, this is not a web standard, but most mobile web browsers have adopted this feature and WebKit also supports it.</p>
<p>Let’s take a look at the viewport meta tag in more detail. The viewport meta tags can be used to set the width, height and initial scale factor of the viewport. Although most web pages don’t have viewport meta tags, mobile browsers which have 320 px screen width can apply initial values to web pages as follows:</p>
<pre><code>&lt;meta name = &quot;viewport&quot; content = &quot;width = 980&quot; initial-scale = &quot;0.32&quot;&gt;
</code></pre><p>In the case of mobile pages, you need to set the viewport meta tags as follows:</p>
<pre><code>&lt;meta name=&quot;viewport&quot; content=&quot;user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width&quot; /&gt;
</code></pre><p>As you can see each property, web pages can not be scaled up/down; even user scaling is turned off. This is because the mobile web pages are actually written for the small screen.</p>
<p>For more information on the viewport meta tags, refer to <a href="http://developer.apple.com/safari/library/documentation/appleapplications/reference/safarihtmlref/articles/metatags.html">the Safari reference library</a>.</p>
<p>Frameset Flattening</p>
<p><a href="http://farm6.static.flickr.com/5263/5597820692_2085d92442.jpg"><img src="http://farm6.static.flickr.com/5263/5597820692_2085d92442.jpg" alt=""></a></p>
<p>There are some web pages that have their own scrollable area with the scroll bars like the above page. We call this &ldquo;sub frame.&rdquo; On touch devices, the problem is that it is desirable not to have any scrollable sub frame of the web page because the user could confuse with sometimes scrolling sub frames and scrolling the web page itself at other times because it is very hard for the user to understand what “sub frame” is. For this reason, iframes and framesets are hardly usable on touch devices.</p>
<p><a href="http://farm6.static.flickr.com/5262/5597236979_36bdab6dc0.jpg"><img src="http://farm6.static.flickr.com/5262/5597236979_36bdab6dc0.jpg" alt=""></a></p>
<p>However, if you enable the frameset flattening features when building Webkit, all the frames can be one scrollable page as you can see the above figure.</p>
<p>To enable the Fameset flattening:</p>
<pre><code>WebKitWebSettings \*settings = webkit\_web\_view\_get\_settings(webView);  
g\_object\_set(G\_OBJECT(settings), &quot;enable-frame-flattening&quot;, TRUE, NULL);  

</code></pre><p>Touch events</p>
<p>Supporting multi-touch has become popular since iPhone introduced it. Now, all smart phones support multi-touch. Using multi-touch allows the users to use more than two fingers to interact with applications on their smart phone. For example, you can use a piano or guitar applications using your 5 fingers.</p>
<p>However, using multi-touch is not only possible for native applications, but also for web pages. Since WebKit supports touch events as DOM events, web developers can deal with touch events using JavaScript. There are 4 kinds of touch events: touchstart, touchmove, touchend, and touchcancel. Unfortunately, WebKitGtk+ doesn&rsquo;t support the touch events yet. So if you want to <a href="https://bug-32434-attachments.webkit.org/attachment.cgi?id=44955">test the touch events</a> , running QtWebKit or mobile Safari would be good. For more information on how to use the touch events, refer to <a href="http://developer.apple.com/library/safari/#documentation/UserExperience/Reference/TouchEventClassReference/TouchEvent/TouchEvent.html#//apple_ref/doc/uid/TP40009358">the Safari reference library</a>.</p>
<p>Finally, I’d like to let you know there are more mobile features I didn’t introduce here, such as intelligent zoom, kinetic scrolling, zooming animation, and etc. WebKit doesn’t support them by itself, but the hosting applications can implement these kind of features, because these features are likely to depend on the platform. However, when these features are added to WebKitGtk+, I will talk about them in more detail.</p>
<p>References</p>
<ul>
<li><a href="http://codeposts.blogspot.com/2010/06/qtwebkit-goes-mobile.html">QtWebKit goes Mobile</a></li>
<li><a href="https://trac.webkit.org/wiki/Mobile%20Features%20Talk">https://trac.webkit.org/wiki/Mobile%20Features%20Talk</a></li>
</ul>

  </section>
  <div class="share">    
    <a
      href="//www.facebook.com/sharer.php?src=bm&u=%2fpost%2fwebkit-mobile-features%2f&t=WebKit%20Mobile%20Features"
      onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"
      ><i class="fa fa-facebook"></i
    ></a>
    <a
      href="//twitter.com/intent/tweet?url=%2fpost%2fwebkit-mobile-features%2f&text=WebKit%20Mobile%20Features&tw_p=tweetbutton"
      onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"
      ><i class="fa fa-twitter"></i
    ></a>
    <a
      href="//getpocket.com/edit?url=%2fpost%2fwebkit-mobile-features%2f&title=WebKit%20Mobile%20Features"
      onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"
      ><i class="fa fa-get-pocket"></i
    ></a>
    <a
      href="//plus.google.com/share?url=%2fpost%2fwebkit-mobile-features%2f"
      onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"
      ><i class="fa fa-google-plus"></i
    ></a>
  </div>
  <div class="post-meta-code">
    <div class="desc">
      Friendly
      
      <a href="mailto:">Joone Hur</a>
      
      wrotes this article at
      <span class="highlight">Saturday, May 21, 2011 01:04</span> 
      for you.
    </div>
    <div class="desc">
      
      <div class="desc">
        <span class="fixed-desc">_tags</span>
        
        
        <a href="/tags/webkit">#Webkit</a>
        
        <a href="/tags/mobile">#mobile</a>
        
        
      </div>
    </div>
  </div>  
  
  <div class="post-comment">    
        
  </div>
  
  <div class="recommend-articles">
    Recommend these articles
    <ul>
      
      <li>
        <a href="/post/webkit-contributors-meeting-2011/" rel="prev">
          <span>WebKit Contributors Meeting 2011</span>
        </a>
      </li>
      
      
      <li>
        <a href="/post/desktop-summit-2011/" rel="next">
          <span>Desktop Summit 2011</span>
        </a>
      </li>
      
    </ul>
  </div>
</div>

<div class="go-top">
  <a href="#" class="go-top-button">
    <i class="fa fa-angle-double-up"></i>
    <span>Top</span>
  </a>
</div>
<footer class="footer">
  (C) <a href="https://joone.github.io"> Joone Hur</a><br />
</footer>
</body>
</html>

